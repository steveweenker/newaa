<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Attendance System</title>

    <!-- ‚úÖ LINK CSS -->
  <link rel="stylesheet" href="css/base.css">
<link rel="stylesheet" href="css/layout.css">
<link rel="stylesheet" href="css/components.css">

  <script src="script.js" defer></script>
    <!-- Optional: JSZip for ZIP export -->
     <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
    

</head>

<body>

   <body>

    <!-- LOGIN SCREEN -->
    <div id="loginOverlay" class="login-wrapper">
        <div class="login-card">
            <div class="login-header">
                <h2>üìö Attendance System</h2>
                <p>Please login to continue</p>
            </div>

            <div class="login-tabs">
                <div class="login-tab active" onclick="switchLoginTab('admin')" data-role="admin">Admin</div>
                <div class="login-tab" onclick="switchLoginTab('faculty')" data-role="faculty">Faculty</div>
                <div class="login-tab" onclick="switchLoginTab('student')" data-role="student">Student</div>
            </div>

            <!-- Admin Login Form -->
            <div id="adminLoginForm" class="login-form active">
                <div class="alert alert-error" id="adminLoginError"></div>
                <form onsubmit="handleAdminLogin(event)">
                    <div class="form-group">
                        <label>Admin Password:</label>
                        <input type="password" id="adminPassword" placeholder="Enter password" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">Login as Admin</button>
                    <p style="margin-top:10px; font-size:12px; color:var(--color-gray); text-align:center;">
                        <!--Default password: admin123-->
                    </p>
                </form>
            </div>

            <!-- Faculty Login Form -->
            <div id="facultyLoginForm" class="login-form">
                <div class="alert alert-error" id="facultyLoginError"></div>
                <form onsubmit="handleFacultyLogin(event)">
                    <div class="form-group">
                        <label>Faculty ID:</label>
                        <input type="text" id="loginFacultyId" placeholder="Enter Faculty ID" required>
                    </div>
                    <div class="form-group">
                        <label>Password:</label>
                        <input type="password" id="loginFacultyPassword" placeholder="Enter password" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">Login as Faculty</button>
                </form>
            </div>

            <!-- Student Login Form -->
            <div id="studentLoginForm" class="login-form">
                <div class="alert alert-error" id="studentLoginError"></div>
                <form onsubmit="handleStudentLogin(event)">
                    <div class="form-group">
                        <label>Registration Number (Roll No):</label>
                        <input type="text" id="loginStudentId" placeholder="Enter Reg No (e.g. 22156148040)" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">Login as Student</button>
                </form>
            </div>
        </div>
    </div>

    <!-- MAIN APP CONTAINER -->
    <div class="container" id="mainContainer">
        <div class="navbar">
            <h1>üìö Advanced Attendance System</h1>
            <div class="navbar-right">
                <div class="user-info">
                    <div id="loggedInUser" style="font-weight: 600;">Admin User</div>
                    <span id="roleBadge" class="user-role-badge">ADMIN</span>
                </div>
                <!-- Add this button for password change -->
                <button class="btn btn-info btn-small" onclick="openPasswordChangeModal()" id="passwordChangeBtn"
                    style="display: none;">üîê Change Password</button>
                <div class="offline-indicator">
                    ‚úÖ Online Mode
                </div>
                <button class="btn btn-danger btn-small" onclick="handleLogout()">Logout</button>
            </div>
        </div>

        <!-- ADMIN PANEL -->
        <div id="adminPanel" class="panel">
            <div class="section">
                <h2 class="section-title">üìä Dashboard</h2>
                <div class="dashboard-grid">
                    <div class="stat-card">
                        <h3>Total Students</h3>
                        <div class="value" id="totalStudents">0</div>
                    </div>
                    <div class="stat-card success">
                        <h3>Total Faculty</h3>
                        <div class="value" id="totalFaculty">0</div>
                    </div>
                    <div class="stat-card warning">
                        <h3>Total Classes</h3>
                        <div class="value" id="totalClasses">0</div>
                    </div>
                    <div class="stat-card danger">
                        <h3>Active Years</h3>
                        <div class="value" id="activeYears">0</div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="tabs">
                    <button class="tab-btn active" onclick="switchAdminTab('users')">Users</button>
                    <button class="tab-btn" onclick="switchAdminTab('faculty')">Faculty</button>
                    <button class="tab-btn" onclick="switchAdminTab('classes')">Classes</button>
                    <button class="tab-btn" onclick="switchAdminTab('years')">Years & Semesters</button>
                    <button class="tab-btn" onclick="switchAdminTab('bulkImport')">Bulk Import</button>
                    <button class="tab-btn" onclick="switchAdminTab('attendanceHistory')">Attendance History</button>
                    <button class="tab-btn" onclick="switchAdminTab('bulkExport')">Bulk Export</button>
                    <button class="tab-btn" onclick="switchAdminTab('settings')">Settings</button>
                </div>

                <!-- Users Tab -->
                <div id="adminUsers" class="tab-content active">
                    <h2 class="section-title">üë• User Management (Students)</h2>

                    <!-- New Filter Dashboard -->
                    <div class="filter-container">
                        <div class="filter-group">
                            <span class="filter-label">üéì Select Academic Year:</span>
                            <div class="filter-btn-group" id="yearFilterGroup">
                                <button class="filter-btn active" onclick="filterStudents('all')">All</button>
                                <button class="filter-btn" onclick="filterStudents(1)">1st Year</button>
                                <button class="filter-btn" onclick="filterStudents(2)">2nd Year</button>
                                <button class="filter-btn" onclick="filterStudents(3)">3rd Year</button>
                                <button class="filter-btn" onclick="filterStudents(4)">4th Year</button>
                            </div>
                        </div>

                        <div class="filter-group" style="margin-top: 15px;">
                            <span class="filter-label">üè´ Select Branch:</span>
                            <select id="branchFilterSelect" onchange="filterByBranch(this.value)"
                                style="padding: 8px; border-radius: 20px; border: 1px solid var(--color-info); background: white; color: var(--color-info); font-weight:600; outline:none; min-width: 200px;">
                                <option value="all">All Branches</option>
                                <option value="Computer Science">Computer Science</option>
                                <option value="Civil">Civil</option>
                                <option value="Mechanical">Mechanical</option>
                                <option value="Electrical">Electrical</option>
                                <option value="ECE">ECE</option>
                                <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                                <option value="CSE(Networks)">CSE(Networks)</option>
                            </select>
                        </div>

                        <div class="filter-group" id="semesterFilterGroup"
                            style="display:none; margin-top:15px; border-top:1px solid #ddd; padding-top:10px;">
                            <span class="filter-label">üìÖ Select Semester:</span>
                            <div class="filter-btn-group" id="semesterButtons">
                                <!-- Dynamic buttons -->
                            </div>
                        </div>

                        <!-- Select All Banner -->
                        <div id="selectAllBanner" class="selection-prompt" style="display:none; margin-top: 15px;">
                            <span id="selectAllText">You have selected 4 students.</span>
                            <button onclick="selectAllListed()">Select all <span id="selectAllCount">0</span> listed
                                students</button>
                        </div>

                        <div id="bulkActionContainer" class="bulk-action-bar" style="display:none;">
                            <div class="bulk-control-group">
                                <strong>üöÄ Increment:</strong>
                                <button class="btn btn-warning" onclick="promoteFilteredStudents()">
                                    +1 Sem <span class="action-target-text">All Listed</span>
                                </button>
                            </div>

                            <div style="width: 1px; height: 30px; background: #ddd; margin: 0 10px;"></div>

                            <div class="bulk-control-group">
                                <strong>üìÖ Set Exact Sem:</strong>
                                <select id="bulkSemSelect"
                                    style="padding: 8px; border-radius: 4px; border: 1px solid #ccc;">
                                    <option value="1">Sem 1</option>
                                    <option value="2">Sem 2</option>
                                    <option value="3">Sem 3</option>
                                    <option value="4">Sem 4</option>
                                    <option value="5">Sem 5</option>
                                    <option value="6">Sem 6</option>
                                    <option value="7">Sem 7</option>
                                    <option value="8">Sem 8</option>
                                </select>
                                <button class="btn btn-info" onclick="setBulkSemester()">Apply to <span
                                        class="action-target-text">All Listed</span></button>
                            </div>

                            <div style="width: 1px; height: 30px; background: #ddd; margin: 0 10px;"></div>

                            <div class="bulk-control-group">
                                <strong>üóëÔ∏è Actions:</strong>
                                <button class="btn btn-danger" onclick="deleteFilteredStudents()">Delete <span
                                        class="action-target-text">Listed</span></button>
                            </div>
                        </div>
                    </div>

                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                        <h3 style="margin:0;">Student List <span id="studentCount"
                                style="font-size:14px; color:gray;">(0)</span></h3>
                        <button class="btn btn-primary" onclick="openModal('addUserModal')">+ Add Student</button>
                    </div>

                    <table id="usersTable">
                        <thead>
                            <tr>
                                <th><input type="checkbox" id="masterCheckbox" onclick="toggleSelectAll()"></th>
                                <th>Roll No</th>
                                <th>Name</th>
                                <th>Dept</th>
                                <th>Year</th>
                                <th>Sem</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                        </tbody>
                    </table>
                </div>

                <!-- Faculty Tab -->
                <div id="adminFaculty" class="tab-content">
                    <h2 class="section-title">üë®‚Äçüè´ Faculty Management</h2>

                    <div class="filter-container">
                        <div class="filter-group">
                            <span class="filter-label">üè¢ Filter by Branch:</span>
                            <select id="facultyBranchFilter" onchange="loadFaculty()"
                                style="padding: 8px; border-radius: 20px; border: 1px solid var(--color-info); background: white; color: var(--color-info); font-weight:600; outline:none; min-width: 200px;">
                                <option value="all">All Departments</option>
                                <option value="Computer Science">Computer Science</option>
                                <option value="Civil">Civil</option>
                                <option value="Mechanical">Mechanical</option>
                                <option value="Electrical">Electrical</option>
                                <option value="ECE">ECE</option>
                                <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                                <option value="CSE(Networks)">CSE(Networks)</option>
                                <option value="Applied Science">Applied Science</option>
                            </select>
                        </div>
                    </div>

                    <div style="margin-bottom: 20px; display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="openModal('addFacultyModal')">+ Add Faculty</button>
                        <button class="btn btn-warning" onclick="openFacultyPasswordResetModal()">üîë Reset Faculty
                            Password</button>
                    </div>
                </div>

                <table id="facultyTable">
                    <thead>
                        <tr>
                            <th>Faculty ID</th>
                            <th>Name</th>
                            <th>Assigned Classes</th>
                            <th>Department</th>
                            <th>Specialization</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="facultyTableBody">
                    </tbody>
                </table>
            </div>

            <!-- Classes Tab -->
            <div id="adminClasses" class="tab-content">
                <h2 class="section-title">üè´ Classes & Subjects</h2>
                <div style="margin-bottom: 20px;">
                    <button class="btn btn-primary" onclick="openModal('addClassModal')">+ Add Class</button>
                    <button class="btn btn-success" onclick="openBatchClassModal()">üìÇ Batch Class Creator</button>
                </div>

                <!-- Class Filters -->
                <div class="filter-container">
                    <div class="filter-group">
                        <span class="filter-label">üéì Filter by Year:</span>
                        <div class="filter-btn-group" id="classYearFilterGroup">
                            <button class="filter-btn active" onclick="filterClasses('all')">All</button>
                            <button class="filter-btn" onclick="filterClasses(1)">1st Year</button>
                            <button class="filter-btn" onclick="filterClasses(2)">2nd Year</button>
                            <button class="filter-btn" onclick="filterClasses(3)">3rd Year</button>
                            <button class="tab-btn" onclick="filterClasses(4)">4th Year</button>
                        </div>
                    </div>

                    <div class="filter-group" id="classSemesterFilterGroup"
                        style="display:none; margin-top:15px; border-top:1px solid #ddd; padding-top:10px;">
                        <span class="filter-label">üìÖ Filter by Semester:</span>
                        <div class="filter-btn-group" id="classSemesterButtons">
                            <!-- Dynamic buttons -->
                        </div>
                    </div>
                </div>

                <table id="classesTable">
                    <thead>
                        <tr>
                            <th>Class Code</th>
                            <th>Course Name</th>
                            <th>Department</th>
                            <th>Semester</th>
                            <th>Faculty</th>
                            <th>Year</th>
                            <th>Credits</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="classesTableBody">
                    </tbody>
                </table>
            </div>

            <!-- Years & Semesters Tab -->
            <div id="adminYears" class="tab-content">
                <h2 class="section-title">üìÖ Years & Semesters</h2>
                <button class="btn btn-primary" onclick="openModal('addYearModal')">+ Add Academic Year</button>

                <div id="yearsContainer"></div>

                <h3 style="margin-top: 30px; margin-bottom: 20px;">Add Custom Semester</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>Year:</label>
                        <input type="number" id="customYearInput" placeholder="e.g., 2024">
                    </div>
                    <div class="form-group">
                        <label>Semester Number:</label>
                        <input type="number" id="customSemesterInput" placeholder="e.g., 1-8" min="1" max="8">
                    </div>
                    <div class="form-group">
                        <label>&nbsp;</label>
                        <button class="btn btn-success" onclick="addCustomSemester()">Add Semester</button>
                    </div>
                </div>
            </div>

            <!-- Bulk Import Tab -->
            <div id="adminBulkImport" class="tab-content">
                <h2 class="section-title">üì§ Bulk Import</h2>

                <div class="alert alert-info">
                    ‚ÑπÔ∏è Import multiple records at once from CSV files. Download templates below and fill with your
                    data.
                </div>

                <div style="margin-bottom: 30px;">
                    <h3 style="margin-bottom: 15px;">üì• Download Templates</h3>
                    <button class="btn btn-secondary" onclick="downloadTemplate('students')">üì• Students
                        Template</button>
                    <button class="btn btn-secondary" onclick="downloadTemplate('faculty')">üì• Faculty
                        Template</button>
                    <button class="btn btn-secondary" onclick="downloadTemplate('classes')">üì• Classes
                        Template</button>
                    <button class="btn btn-warning" onclick="downloadCompleteDbTemplate()">üì• Complete DB
                        Template</button>
                </div>

                <!-- Students Import -->
                <h3 style="margin-bottom: 15px;">üìö Import Students (CSV)</h3>
                <div class="file-upload-area" id="studentUploadArea"
                    onclick="document.getElementById('studentFile').click()">
                    <div style="font-size: 40px;">üìÑ</div>
                    <p><strong>Click to upload or drag & drop</strong></p>
                    <p style="color: var(--color-gray); font-size: 12px;">CSV file only</p>
                    <input type="file" id="studentFile" accept=".csv" style="display:none;"
                        onchange="handleStudentUpload(event)">
                </div>
                <div class="import-progress" id="studentProgress">
                    <div>Importing students...</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="studentProgressBar" style="width: 0%">0%</div>
                    </div>
                </div>

                <!-- Faculty Import -->
                <h3 style="margin-top: 30px; margin-bottom: 15px;">üë• Import Faculty (CSV)</h3>
                <div class="file-upload-area" id="facultyUploadArea"
                    onclick="document.getElementById('facultyFile').click()">
                    <div style="font-size: 40px;">üìÑ</div>
                    <p><strong>Click to upload or drag & drop</strong></p>
                    <p style="color: var(--color-gray); font-size: 12px;">CSV file only</p>
                    <input type="file" id="facultyFile" accept=".csv" style="display:none;"
                        onchange="handleFacultyUpload(event)">
                </div>
                <div class="import-progress" id="facultyProgress">
                    <div>Importing faculty...</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="facultyProgressBar" style="width: 0%">0%</div>
                    </div>
                </div>

                <!-- Classes Import -->
                <h3 style="margin-top: 30px; margin-bottom: 15px;">üè´ Import Classes (CSV)</h3>
                <div class="file-upload-area" id="classesUploadArea"
                    onclick="document.getElementById('classesFile').click()">
                    <div style="font-size: 40px;">üìÑ</div>
                    <p><strong>Click to upload or drag & drop</strong></p>
                    <p style="color: var(--color-gray); font-size: 12px;">CSV file only</p>
                    <input type="file" id="classesFile" accept=".csv" style="display:none;"
                        onchange="handleClassesUpload(event)">
                </div>
                <div class="import-progress" id="classesProgress">
                    <div>Importing classes...</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="classesProgressBar" style="width: 0%">0%</div>
                    </div>
                </div>

                <!-- Complete Database Import -->
                <div style="margin-top: 40px; padding-top: 20px; border-top: 2px solid var(--color-light);">
                    <h3 style="margin-bottom: 15px;">üîÅ Complete Database Import (ZIP/JSON)</h3>
                    <div class="alert alert-info">
                        ‚ÑπÔ∏è Import a complete database backup ZIP file or JSON file. This will restore all data
                        including attendance records.
                        <strong>Warning:</strong> This will replace existing data.
                    </div>

                    <div class="file-upload-area" id="completeDbUploadArea"
                        onclick="document.getElementById('completeDbFile').click()">
                        <div style="font-size: 40px;">üì¶</div>
                        <p><strong>Click to upload complete database backup</strong></p>
                        <p style="color: var(--color-gray); font-size: 12px;">ZIP file or JSON backup</p>
                        <input type="file" id="completeDbFile" accept=".zip,.json,.ZIP,.JSON" style="display:none;"
                            onchange="handleCompleteDbUpload(event)">
                    </div>

                    <div class="import-progress" id="completeDbProgress">
                        <div>Importing complete database...</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="completeDbProgressBar" style="width: 0%">0%</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Attendance History Tab -->
            <div id="adminAttendanceHistory" class="tab-content">
                <h2 class="section-title">üìä Attendance History Reports</h2>

                <div class="filter-container" style="margin-bottom: 30px;">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Select Year:</label>
                            <select id="adminYearFilter">
                                <option value="all">All Years</option>
                                <option value="1">1st Year</option>
                                <option value="2">2nd Year</option>
                                <option value="3">3rd Year</option>
                                <option value="4">4th Year</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Select Branch:</label>
                            <select id="adminBranchFilter">
                                <option value="all">All Branches</option>
                                <option value="Computer Science">Computer Science</option>
                                <option value="Civil">Civil</option>
                                <option value="Mechanical">Mechanical</option>
                                <option value="Electrical">Electrical</option>
                                <option value="ECE">ECE</option>
                                <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                                <option value="CSE(Networks)">CSE(Networks)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Select Semester:</label>
                            <select id="adminSemesterFilter">
                                <option value="all">All Semesters</option>
                                <option value="1">Semester 1</option>
                                <option value="2">Semester 2</option>
                                <option value="3">Semester 3</option>
                                <option value="4">Semester 4</option>
                                <option value="5">Semester 5</option>
                                <option value="6">Semester 6</option>
                                <option value="7">Semester 7</option>
                                <option value="8">Semester 8</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Select Class:</label>
                            <select id="adminClassFilter">
                                <option value="all">All Classes</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Date Filter:</label>
                            <div style="margin-bottom: 10px;">
                                <label style="display: flex; align-items: center; gap: 5px; margin-bottom: 5px;">
                                    <input type="radio" name="dateFilterType" value="all" checked
                                        onchange="toggleDateRange()">
                                    <span>All Records</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="dateFilterType" value="range"
                                        onchange="toggleDateRange()">
                                    <span>Date Range</span>
                                </label>
                            </div>
                            <div id="dateRangeInputs" style="display: none; margin-top: 10px;">
                                <div style="display: flex; gap: 10px; align-items: center;">
                                    <input type="date" id="adminDateFrom" style="flex: 1;">
                                    <span>to</span>
                                    <input type="date" id="adminDateTo" style="flex: 1;">
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Status Filter:</label>
                            <select id="adminStatusFilter">
                                <option value="all">All Status</option>
                                <option value="present">Present Only</option>
                                <option value="absent">Absent Only</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Sort By:</label>
                            <select id="adminSortBy">
                                <option value="percentage_desc">Percentage (High to Low)</option>
                                <option value="percentage_asc">Percentage (Low to High)</option>
                                <option value="rollno_asc">Roll No (Ascending)</option>
                                <option value="rollno_desc">Roll No (Descending)</option>
                                <option value="name_asc">Name (A-Z)</option>
                                <option value="name_desc">Name (Z-A)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>&nbsp;</label>
                            <button class="btn btn-primary" onclick="loadAdminAttendanceHistory()">üìä Load
                                Attendance</button>
                            <button class="btn btn-info" onclick="loadAdminAttendanceHistory()">üîÑ Refresh</button>
                            <button class="btn btn-secondary" onclick="clearAdminFilters()">üßπ Clear
                                Filters</button>
                        </div>
                    </div>
                </div>

                <div style="margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
                    <h3>Attendance Records <span id="adminRecordCount">(0)</span></h3>
                    <div>
                        <button class="btn btn-success" onclick="exportAdminHistory('csv')">üì• Export CSV</button>
                        <button class="btn btn-danger" onclick="exportAdminHistory('pdf')">üì• Export PDF</button>
                        <button class="btn btn-primary" onclick="exportAdminHistory('excel')">üì• Export
                            Excel</button>
                        <button class="btn btn-warning" onclick="exportAdminHistory('json')">üì• Export JSON</button>
                    </div>
                </div>

                <!-- Year-wise Attendance Summary Section -->
                <div id="yearWiseAttendanceSection" style="margin-bottom: 30px;">
                    <h3>üìà Year-wise Attendance Summary</h3>
                    <div id="yearWiseAttendanceSummary" style="margin-top: 15px;">
                        <!-- Will be populated dynamically -->
                    </div>
                </div>

                <div id="adminAttendanceTableContainer">
                    <table id="adminAttendanceTable">
                        <thead>
                            <tr>
                                <th>Roll No</th>
                                <th>Student Name</th>
                                <th>Department</th>
                                <th>Year</th>
                                <th>Semester</th>
                                <th>Class</th>
                                <th>Total Classes</th>
                                <th>Present</th>
                                <th>Absent</th>
                                <th>Attendance %</th>
                            </tr>
                        </thead>
                        <tbody id="adminAttendanceBody">
                            <!-- Records will be loaded here -->
                        </tbody>
                    </table>
                </div>

                <div id="adminAttendanceStats"
                    style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 8px;">
                    <h4>üìà Statistics</h4>
                    <div class="dashboard-grid" style="margin-top: 15px;">
                        <div class="stat-card" style="background: linear-gradient(135deg, #27ae60, #229954);">
                            <h3>Total Students</h3>
                            <div class="value" id="statTotalRecords">0</div>
                        </div>
                        <div class="stat-card" style="background: linear-gradient(135deg, #3498db, #2980b9);">
                            <h3>Average Attendance %</h3>
                            <div class="value" id="statAvgPercentage">0%</div>
                        </div>
                        <div class="stat-card" style="background: linear-gradient(135deg, #f39c12, #d68910);">
                            <h3>Above 75%</h3>
                            <div class="value" id="statAbove75">0</div>
                        </div>
                        <div class="stat-card" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">
                            <h3>Below 75%</h3>
                            <div class="value" id="statBelow75">0</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bulk Export Tab -->
            <div id="adminBulkExport" class="tab-content">
                <h2 class="section-title">üì§ Bulk Export</h2>

                <div class="alert alert-info">
                    ‚ÑπÔ∏è Export complete datasets in CSV format. Data is grouped by year where applicable.
                </div>

                <div class="dashboard-grid" style="margin-top: 30px;">
                    <!-- Students Export Card -->
                    <div class="stat-card"
                        style="background: linear-gradient(135deg, #1f96d3, #1a7ca8); cursor: pointer;"
                        onclick="exportBulkData('students')">
                        <div style="font-size: 40px; margin-bottom: 10px;">üë•</div>
                        <h3>Export Students</h3>
                        <p style="opacity: 0.9; font-size: 14px; margin-top: 10px;">
                            Year-wise grouping<br>
                            All student details included
                        </p>
                    </div>

                    <!-- Classes Export Card -->
                    <div class="stat-card"
                        style="background: linear-gradient(135deg, #27ae60, #229954); cursor: pointer;"
                        onclick="exportBulkData('classes')">
                        <div style="font-size: 40px; margin-bottom: 10px;">üìö</div>
                        <h3>Export Classes</h3>
                        <p style="opacity: 0.9; font-size: 14px; margin-top: 10px;">
                            Year-wise grouping<br>
                            All class details included
                        </p>
                    </div>

                    <!-- Faculty Export Card -->
                    <div class="stat-card"
                        style="background: linear-gradient(135deg, #f39c12, #d68910); cursor: pointer;"
                        onclick="exportBulkData('faculty')">
                        <div style="font-size: 40px; margin-bottom: 10px;">üë®‚Äçüè´</div>
                        <h3>Export Faculty</h3>
                        <p style="opacity: 0.9; font-size: 14px; margin-top: 10px;">
                            Complete faculty list<br>
                            All details included
                        </p>
                    </div>

                    <!-- All-in-One Export Card -->
                    <div class="stat-card"
                        style="background: linear-gradient(135deg, #9b59b6, #8e44ad); cursor: pointer;"
                        onclick="exportAllInOne()">
                        <div style="font-size: 40px; margin-bottom: 10px;">üì¶</div>
                        <h3>Export All Data</h3>
                        <p style="opacity: 0.9; font-size: 14px; margin-top: 10px;">
                            Students + Classes + Faculty<br>
                            Multiple CSV files
                        </p>
                    </div>

                    <!-- Complete Database Export Card -->
                    <div class="stat-card"
                        style="background: linear-gradient(135deg, #e67e22, #d35400); cursor: pointer;"
                        onclick="exportCompleteDatabase()">
                        <div style="font-size: 40px; margin-bottom: 10px;">üíæ</div>
                        <h3>Complete Database Export</h3>
                        <p style="opacity: 0.9; font-size: 14px; margin-top: 10px;">
                            EVERYTHING in one ZIP<br>
                            Including attendance history
                        </p>
                    </div>
                </div>

                <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 8px;">
                    <h3>üìä Export Statistics</h3>
                    <div style="display: flex; gap: 20px; margin-top: 15px; flex-wrap: wrap;">
                        <div style="flex: 1; min-width: 200px;">
                            <h4>Students</h4>
                            <div id="exportStudentCount" style="font-size: 24px; font-weight: bold; color: #1f96d3;">0
                            </div>
                            <p style="font-size: 12px; color: gray;">Total students available for export</p>
                        </div>
                        <div style="flex: 1; min-width: 200px;">
                            <h4>Faculty</h4>
                            <div id="exportFacultyCount" style="font-size: 24px; font-weight: bold; color: #27ae60;">0
                            </div>
                            <p style="font-size: 12px; color: gray;">Total faculty available for export</p>
                        </div>
                        <div style="flex: 1; min-width: 200px;">
                            <h4>Classes</h4>
                            <div id="exportClassCount" style="font-size: 24px; font-weight: bold; color: #f39c12;">0
                            </div>
                            <p style="font-size: 12px; color: gray;">Total classes available for export</p>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 30px;">
                    <h3>‚ÑπÔ∏è Export Information</h3>
                    <ul style="color: var(--color-gray); margin-top: 10px; line-height: 1.6;">
                        <li>All exports are in CSV format (compatible with Excel)</li>
                        <li>Students are grouped by academic year</li>
                        <li>Classes are grouped by academic year</li>
                        <li>Faculty export includes all details including specialization</li>
                        <li>Use "Export All Data" to get everything in one go</li>
                        <li><strong>"Complete Database Export" includes attendance records and settings</strong>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="adminSettings" class="tab-content">
                <h2 class="section-title">‚öôÔ∏è Settings</h2>
                <form onsubmit="saveSettings(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label>College Name:</label>
                            <input type="text" id="collegeName" value="Engineering College">
                        </div>
                        <div class="form-group">
                            <label>Min Attendance (%):</label>
                            <input type="number" id="minAttendance" value="75" min="0" max="100">
                        </div>
                    </div>
                    <button type="submit" class="btn btn-success">üíæ Save</button>
                    <button type="button" class="btn btn-secondary" onclick="exportAllData()">üì• Export All
                        Data</button>
                    <button type="button" class="btn btn-danger" onclick="clearAllStudents()"
                        style="margin-left: 10px;">üóëÔ∏è Clear All Students</button>
                </form>
            </div>
        </div>
    </div>

    <!-- FACULTY PANEL -->
    <div id="facultyPanel" class="panel">
        <div class="section">
            <div class="tabs" style="margin-bottom: 20px;">
                <button class="tab-btn active" onclick="switchFacultyTab('mark', event)">Mark Attendance</button>
                <button class="tab-btn" onclick="switchFacultyTab('history', event)">Date-wise History</button>
                <button class="tab-btn" onclick="switchFacultyTab('report', event)">Report</button>
            </div>

            <!-- Mark Attendance Tab -->
            <div id="facultyMark" class="tab-content active">
                <h2 class="section-title">‚úÖ Mark Attendance (Multi-Session Support)</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label>Select Class:</label>
                        <select id="facultyClassSelect" onchange="loadClassStudents()">
                            <option value="">-- Select a class --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Date:</label>
                        <input type="date" id="attendanceDate">
                    </div>
                    <div class="form-group">
                        <label>Session:</label>
                        <select id="attendanceSession">
                            <option value="1">Session 1</option>
                            <option value="2">Session 2</option>
                            <option value="3">Session 3</option>
                            <option value="4">Session 4</option>
                            <option value="5">Session 5</option>
                        </select>
                    </div>
                </div>

                <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                    <button class="btn btn-secondary" onclick="openBulkAttendanceModal()">üìÇ Bulk
                        Upload</button>
                    <button class="btn btn-info" onclick="downloadAttendanceReport()">üì• Download Report
                        (CSV)</button>
                    <button class="btn btn-warning" id="multiSessionBtn" style="display:none;">üìÖ Mark Multiple
                        Sessions</button>
                </div>

                <!-- Add Student/Batch to Session Logic -->
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <h4 style="margin-bottom:10px; color:var(--color-gray);">‚ûï Add Extra Students
                        (Electives/Backlogs)</h4>

                    <div style="display: flex; gap: 10px; align-items: center; margin-bottom: 15px;">
                        <input type="text" id="addStudentToSessionInput" placeholder="Enter Roll No (e.g. 22156...)"
                            style="flex:1;">
                        <button class="btn btn-info" onclick="addStudentToSession()">Add Single Student</button>
                    </div>

                    <div style="display: flex; gap: 10px; align-items: center; flex-wrap:wrap;">
                        <select id="addBatchBranch" style="flex:1; min-width: 200px;">
                            <option value="">-- Select Branch --</option>
                            <option value="Computer Science">Computer Science</option>
                            <option value="Civil">Civil</option>
                            <option value="Mechanical">Mechanical</option>
                            <option value="Electrical">Electrical</option>
                            <option value="ECE">ECE</option>
                            <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                            <option value="CSE(Networks)">CSE(Networks)</option>
                            <option value="Applied Science">Applied Science</option>
                        </select>
                        <select id="addBatchSem" style="width: 150px;">
                            <option value="">-- Sem --</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                        </select>
                        <button class="btn btn-warning" onclick="addBatchToSession()">Add Whole Batch</button>
                    </div>
                </div>

                <div id="studentGridContainer" style="display:none;">
                    <div id="studentGrid"></div>
                    <div style="margin-top: 20px;">
                        <button class="btn btn-success" onclick="submitAttendance()">‚úîÔ∏è Submit Attendance for
                            Session <span id="currentSessionDisplay">1</span></button>
                        <button class="btn btn-secondary" onclick="resetAttendance()">üîÑ Reset</button>
                    </div>
                </div>
            </div>

            <!-- Date-wise History Tab -->
            <div id="facultyHistory" class="tab-content">
                <h2 class="section-title">üìÖ Attendance History (Multi-Session)</h2>
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                    <p style="color: gray; margin:0;">Select a date to view or edit attendance for the selected
                        class.</p>
                    <button class="btn btn-success" onclick="downloadHistoryCSV()">üíæ Download History
                        (CSV)</button>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Select Class:</label>
                        <select id="historyClassSelect" onchange="loadAttendanceHistory()">
                            <option value="">-- Select a class --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Filter Date (Optional):</label>
                        <input type="date" id="historyDateFilter" onchange="loadAttendanceHistory()">
                    </div>
                </div>

                <div id="historyList" style="margin-top: 20px;"></div>
            </div>

            <!-- Report Tab -->
            <div id="facultyReport" class="tab-content">
                <h2 class="section-title">üìà Year-wise Attendance Report</h2>
                <div class="year-filter" id="yearFilter"></div>
                <table id="yearWiseAttendanceTable">
                    <thead>
                        <tr>
                            <th>Year</th>
                            <th>Classes Held (Records)</th>
                            <th>Total Attended</th>
                            <th>Absent</th>
                            <th>Attendance %</th>
                        </tr>
                    </thead>
                    <tbody id="yearWiseAttendanceBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- STUDENT PANEL -->
    <div id="studentPanel" class="panel">
        <div class="section">
            <h2 class="section-title">üë§ Student Profile</h2>
            <div
                style="background: var(--color-light); padding: 20px; border-radius: 8px; display: flex; flex-wrap: wrap; gap: 20px; align-items: center;">
                <div style="flex: 1; min-width: 200px;">
                    <h3 id="studentNameDisplay" style="color: var(--color-primary); margin-bottom: 5px;">Student
                        Name</h3>
                    <p id="studentRollDisplay" style="font-weight: 600; color: var(--color-gray);">Roll No: -</p>
                </div>
                <div style="flex: 1; min-width: 200px;">
                    <p><strong>Email:</strong> <span id="studentEmailDisplay">-</span></p>
                    <p><strong>Department:</strong> <span id="studentDeptDisplay">-</span></p>
                    <p><strong>Semester:</strong> <span id="studentSemDisplay">-</span></p>
                    <p><strong>Year:</strong> <span id="studentYearDisplay">-</span></p>
                </div>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title">üìö My Attendance</h2>
            <table id="studentAttendanceTable">
                <thead>
                    <tr>
                        <th>Course</th>
                        <th>Faculty</th>
                        <th>Total Classes (Sessions)</th>
                        <th>Attended</th>
                        <th>Percentage</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="studentAttendanceBody">
                    <tr>
                        <td colspan="6" style="text-align:center;">No attendance records found yet.</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    </div>

    <!-- Modals -->
    <!-- Faculty Profile Modal -->
    <div id="facultyProfileModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                Faculty Profile
                <button class="close-btn" onclick="closeModal('facultyProfileModal')">&times;</button>
            </div>
            <div id="facultyProfileContent"></div>
            <div style="margin-top: 20px; text-align: right;">
                <button class="btn btn-info" id="btnEditFacultyClasses">‚úèÔ∏è Edit Profile & Classes</button>
                <button class="btn btn-secondary" onclick="closeModal('facultyProfileModal')">Close</button>
            </div>
        </div>
    </div>

    <!-- Add Student Modal -->
    <div id="addUserModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                Add Student
                <button class="close-btn" onclick="closeModal('addUserModal')">&times;</button>
            </div>
            <form onsubmit="addStudent(event)">
                <div class="form-group">
                    <label>Roll No:</label>
                    <input type="text" id="studentRollNo" oninput="autoFillStudentDetails()" required>
                    <small style="color:var(--color-info);">Enter Roll No (e.g. 22156...) to auto-fill details</small>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>First Name:</label>
                        <input type="text" id="studentFirstName" required>
                    </div>
                    <div class="form-group">
                        <label>Last Name:</label>
                        <input type="text" id="studentLastName" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="studentEmail" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Department:</label>
                        <select id="studentDept" required>
                            <option value="">-- Select --</option>
                            <option value="Computer Science">Computer Science</option>
                            <option value="Civil">Civil</option>
                            <option value="Mechanical">Mechanical</option>
                            <option value="Electrical">Electrical</option>
                            <option value="ECE">ECE</option>
                            <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                            <option value="CSE(Networks)">CSE(Networks)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Year:</label>
                        <input type="number" id="studentYear" required>
                    </div>
                    <div class="form-group">
                        <label>Semester:</label>
                        <select id="studentSemester" required>
                            <option value="">-- Select --</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                        </select>
                    </div>
                </div>
                <button type="submit" class="btn btn-success">Add Student</button>
            </form>
        </div>
    </div>

    <!-- Add Faculty Modal -->
    <div id="addFacultyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                Add Faculty
                <button class="close-btn" onclick="closeModal('addFacultyModal')">&times;</button>
            </div>
            <form onsubmit="addFaculty(event)">
                <div class="form-group">
                    <label>Faculty ID:</label>
                    <input type="text" id="facultyId" required>
                </div>
                <div class="form-group">
                    <label>Password:</label>
                    <input type="password" id="facultyPassword" placeholder="Set login password" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>First Name:</label>
                        <input type="text" id="facultyFirstName" required>
                    </div>
                    <div class="form-group">
                        <label>Last Name:</label>
                        <input type="text" id="facultyLastName" required>
                    </div>
                </div>
                <div class="form-group">
                    <label class="optional-label">Email</label>
                    <input type="email" id="facultyEmail" placeholder="Optional field">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Department:</label>
                        <select id="facultyDept" required>
                            <option value="">-- Select --</option>
                            <option value="Computer Science">Computer Science</option>
                            <option value="Civil">Civil</option>
                            <option value="Mechanical">Mechanical</option>
                            <option value="Electrical">Electrical</option>
                            <option value="ECE">ECE</option>
                            <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                            <option value="CSE(Networks)">CSE(Networks)</option>
                            <option value="Applied Science">Applied Science</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="optional-label">Specialization</label>
                        <input type="text" id="facultySpecial" placeholder="Optional field">
                    </div>
                </div>
                <button type="submit" class="btn btn-success">Add Faculty</button>
            </form>
        </div>
    </div>

    <!-- Edit Faculty Modal -->
    <div id="editFacultyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                Edit Faculty
                <button class="close-btn" onclick="closeModal('editFacultyModal')">&times;</button>
            </div>
            <form onsubmit="updateFaculty(event)">
                <input type="hidden" id="editFacultyIdKey">
                <div class="form-group">
                    <label>Faculty ID:</label>
                    <input type="text" id="editFacultyId" required>
                </div>
                <div class="form-group">
                    <label>Password (Leave blank to keep current):</label>
                    <input type="password" id="editFacultyPassword" placeholder="Enter new password to change">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>First Name:</label>
                        <input type="text" id="editFacultyFirstName" required>
                    </div>
                    <div class="form-group">
                        <label>Last Name:</label>
                        <input type="text" id="editFacultyLastName" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="editFacultyEmail">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Department:</label>
                        <select id="editFacultyDept" required>
                            <option value="">-- Select --</option>
                            <option value="Computer Science">Computer Science</option>
                            <option value="Civil">Civil</option>
                            <option value="Mechanical">Mechanical</option>
                            <option value="Electrical">Electrical</option>
                            <option value="ECE">ECE</option>
                            <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                            <option value="CSE(Networks)">CSE(Networks)</option>
                            <option value="Applied Science">Applied Science</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Specialization:</label>
                        <input type="text" id="editFacultySpecial">
                    </div>
                </div>

                <h4 style="margin-bottom:10px; margin-top:20px; border-bottom:1px solid #ddd; padding-bottom:5px;">
                    Assign Classes</h4>
                <p style="font-size:12px; color:gray; margin-bottom:10px;">Select classes to assign to this faculty
                    member.</p>
                <div class="class-assignment-grid" id="editFacultyClassesList"></div>

                <div style="margin-top:20px;">
                    <button type="submit" class="btn btn-success">Update Faculty</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Class Modal -->
    <div id="addClassModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                Add Class
                <button class="close-btn" onclick="closeModal('addClassModal')">&times;</button>
            </div>
            <form onsubmit="addClass(event)">
                <div class="form-group">
                    <label>Class Code:</label>
                    <input type="text" id="classCode" required>
                </div>
                <div class="form-group">
                    <label>Course Name:</label>
                    <input type="text" id="courseName" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Department:</label>
                        <select id="classDept" required>
                            <option value="">-- Select --</option>
                            <option value="Computer Science">Computer Science</option>
                            <option value="Civil">Civil</option>
                            <option value="Mechanical">Mechanical</option>
                            <option value="Electrical">Electrical</option>
                            <option value="ECE">ECE</option>
                            <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                            <option value="CSE(Networks)">CSE(Networks)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Semester:</label>
                        <input type="number" id="classSemester" required>
                    </div>
                    <div class="form-group">
                        <label>Year:</label>
                        <input type="number" id="classYear" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Faculty:</label>
                        <select id="classFaculty" required></select>
                    </div>
                    <div class="form-group">
                        <label>Credits:</label>
                        <input type="number" id="classCredits" value="3">
                    </div>
                </div>
                <button type="submit" class="btn btn-success">Add Class</button>
            </form>
        </div>
    </div>

    <!-- Edit Class Modal -->
    <div id="editClassModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                Edit Class
                <button class="close-btn" onclick="closeModal('editClassModal')">&times;</button>
            </div>
            <form onsubmit="updateClass(event)">
                <input type="hidden" id="editClassIdKey">
                <div class="form-group">
                    <label>Class Code:</label>
                    <input type="text" id="editClassCode" required>
                </div>
                <div class="form-group">
                    <label>Course Name:</label>
                    <input type="text" id="editCourseName" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Department:</label>
                        <select id="editClassDept" required>
                            <option value="">-- Select --</option>
                            <option value="Computer Science">Computer Science</option>
                            <option value="Civil">Civil</option>
                            <option value="Mechanical">Mechanical</option>
                            <option value="Electrical">Electrical</option>
                            <option value="ECE">ECE</option>
                            <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                            <option value="CSE(Networks)">CSE(Networks)</option>
                            <option value="Applied Science">Applied Science</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Semester:</label>
                        <input type="number" id="editClassSemester" required>
                    </div>
                    <div class="form-group">
                        <label>Year:</label>
                        <input type="number" id="editClassYear" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Faculty:</label>
                        <select id="editClassFaculty" required></select>
                    </div>
                    <div class="form-group">
                        <label>Credits:</label>
                        <input type="number" id="editClassCredits" value="3">
                    </div>
                </div>
                <button type="submit" class="btn btn-success">Update Class</button>
            </form>
        </div>
    </div>

    <!-- Batch Class Creator Modal -->
    <div id="batchClassModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                Batch Class Creator
                <button class="close-btn" onclick="closeModal('batchClassModal')">&times;</button>
            </div>
            <div class="alert alert-info">
                ‚ÑπÔ∏è Paste your class list in the format: <strong>Semester, Subject Name, Subject Code, Faculty
                    Name</strong>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Branch / Department (Applied to all):</label>
                    <select id="batchBranch" required>
                        <option value="Computer Science">Computer Science</option>
                        <option value="Civil">Civil</option>
                        <option value="Mechanical">Mechanical</option>
                        <option value="Electrical">Electrical</option>
                        <option value="ECE">ECE</option>
                        <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                        <option value="CSE(Networks)">CSE(Networks)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Year (Applied to all):</label>
                    <input type="number" id="batchYear" value="2024">
                </div>
            </div>

            <div class="form-group">
                <label>Paste Data (Each line is a new subject):</label>
                <textarea id="batchClassInput" rows="6"
                    placeholder="Example:\n1, Mathematics-I, MAT101, Dr. Smith\n1, Physics, PHY101, Prof. Doe"></textarea>
            </div>

            <button class="btn btn-primary" onclick="previewBatchClasses()">üîç Parse & Preview</button>

            <div id="batchPreviewArea" style="display:none; margin-top: 20px;">
                <h3>Preview</h3>
                <table id="batchPreviewTable">
                    <thead>
                        <tr>
                            <th>Sem</th>
                            <th>Subject</th>
                            <th>Code</th>
                            <th>Faculty</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <div style="margin-top: 20px; text-align: right;">
                    <button class="btn btn-success" onclick="saveBatchClasses()">üíæ Save All Classes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bulk Attendance Modal -->
    <div id="bulkAttendanceModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                Bulk Upload Attendance (Multi-Session)
                <button class="close-btn" onclick="closeModal('bulkAttendanceModal')">&times;</button>
            </div>
            <div class="alert alert-info">
                Paste student Roll Numbers for the selected class. <br>
                Format: <strong>RollNo</strong> (Default: Present) or <strong>RollNo, Status (P/A)</strong><br>
                <strong>Note:</strong> This will be saved for the currently selected session.
            </div>

            <div class="form-group">
                <label>Session (for this bulk upload):</label>
                <select id="bulkAttendanceSession" style="margin-bottom: 15px;">
                    <option value="1">Session 1</option>
                    <option value="2">Session 2</option>
                    <option value="3">Session 3</option>
                    <option value="4">Session 4</option>
                    <option value="5">Session 5</option>
                </select>
            </div>

            <div class="form-group">
                <label>Attendance Data:</label>
                <textarea id="bulkAttendanceInput" rows="10"
                    placeholder="22156148040, P\n22156148041, A\n..."></textarea>
            </div>
            <button class="btn btn-success" onclick="saveBulkAttendance()">üíæ Upload & Save for Selected
                Session</button>
        </div>
    </div>

    <!-- Add Year Modal -->
    <div id="addYearModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                Add Academic Year
                <button class="close-btn" onclick="closeModal('addYearModal')">&times;</button>
            </div>
            <form onsubmit="addAcademicYear(event)">
                <div class="form-group">
                    <label>Year (e.g., 2024):</label>
                    <input type="number" id="academicYear" placeholder="2024" required>
                </div>
                <div class="form-group">
                    <label>Start Date:</label>
                    <input type="date" id="yearStartDate" required>
                </div>
                <div class="form-group">
                    <label>End Date:</label>
                    <input type="date" id="yearEndDate" required>
                </div>
                <button type="submit" class="btn btn-success">Add Year</button>
            </form>
        </div>
    </div>

    <!-- Edit Attendance Modal -->
    <div id="editAttendanceModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                Edit Attendance Record
                <button class="close-btn" onclick="closeModal('editAttendanceModal')">&times;</button>
            </div>
            <form onsubmit="saveEditedAttendance(event)">
                <input type="hidden" id="editAttendanceId">
                <input type="hidden" id="editAttendanceStudentId">

                <div class="profile-info-grid">
                    <div class="profile-info-item">
                        <label>Student</label>
                        <div id="editStudentInfo">-</div>
                    </div>
                    <div class="profile-info-item">
                        <label>Class</label>
                        <div id="editClassInfo">-</div>
                    </div>
                    <div class="profile-info-item">
                        <label>Date & Session</label>
                        <div id="editDateInfo">-</div>
                    </div>
                    <div class="profile-info-item">
                        <label>Faculty</label>
                        <div id="editFacultyInfo">-</div>
                    </div>
                </div>

                <div class="form-group" style="margin-top: 10px;">
                    <label>Session:</label>
                    <select id="editSessionSelector">
                        <option value="1">Session 1</option>
                        <option value="2">Session 2</option>
                        <option value="3">Session 3</option>
                        <option value="4">Session 4</option>
                        <option value="5">Session 5</option>
                    </select>
                </div>

                <div class="form-group" style="margin-top: 20px;">
                    <label>Attendance Status:</label>
                    <div style="display: flex; gap: 15px; margin-top: 10px;">
                        <label style="display: flex; align-items: center; gap: 5px;">
                            <input type="radio" name="attendanceStatus" value="present" checked>
                            <span
                                style="padding: 8px 15px; background: #d4edda; color: #155724; border-radius: 4px;">Present</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 5px;">
                            <input type="radio" name="attendanceStatus" value="absent">
                            <span
                                style="padding: 8px 15px; background: #f8d7da; color: #721c24; border-radius: 4px;">Absent</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="optional-label">Notes (Optional)</label>
                    <textarea id="editAttendanceNotes" rows="3"
                        placeholder="Add any notes about this attendance record..."></textarea>
                </div>

                <div style="margin-top: 20px; display: flex; justify-content: space-between;">
                    <button type="button" class="btn btn-danger" onclick="deleteAttendanceRecord()">üóëÔ∏è Delete
                        Record</button>
                    <div>
                        <button type="button" class="btn btn-secondary"
                            onclick="closeModal('editAttendanceModal')">Cancel</button>
                        <button type="submit" class="btn btn-success">üíæ Save Changes</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Generic Confirmation Modal -->
    <!-- Generic Confirmation Modal -->
    <div id="confirmationModal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                Confirm Action
                <button class="close-btn" onclick="closeModal('confirmationModal')">&times;</button>
            </div>
            <p id="confirmationMessage" style="margin-bottom: 25px; font-size: 16px;">Are you sure?</p>
            <div style="display: flex; justify-content: flex-end; gap: 10px;">
                <button class="btn btn-secondary" onclick="closeModal('confirmationModal')">Cancel</button>
                <button class="btn btn-danger" id="confirmActionBtn">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Password Change Modal -->
    <div id="passwordChangeModal" class="modal">
        <div class="modal-content" style="max-width: 450px;">
            <div class="modal-header">
                üîê Change Password
                <button class="close-btn" onclick="closeModal('passwordChangeModal')">&times;</button>
            </div>
            <form onsubmit="handlePasswordChange(event)">
                <div class="form-group">
                    <label>Current Password:</label>
                    <input type="password" id="currentPassword" required>
                </div>
                <div class="form-group">
                    <label>New Password:</label>
                    <input type="password" id="newPassword" required minlength="6">
                </div>
                <div class="form-group">
                    <label>Confirm New Password:</label>
                    <input type="password" id="confirmPassword" required minlength="6">
                </div>
                <div class="alert alert-error" id="passwordChangeError" style="display:none;"></div>
                <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" class="btn btn-secondary"
                        onclick="closeModal('passwordChangeModal')">Cancel</button>
                    <button type="submit" class="btn btn-success">Change Password</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Faculty Password Reset Modal (Admin Only) -->
    <div id="facultyPasswordResetModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                üîë Reset Faculty Password
                <button class="close-btn" onclick="closeModal('facultyPasswordResetModal')">&times;</button>
            </div>
            <div class="form-group">
                <label>Select Faculty:</label>
                <select id="resetFacultySelect" style="width: 100%; padding: 10px; margin-bottom: 15px;">
                    <option value="">-- Select Faculty --</option>
                </select>
            </div>
            <div class="form-group">
                <label>New Password:</label>
                <input type="text" id="resetFacultyPassword" value="password123" style="font-family: monospace;">
                <small style="color: var(--color-gray); font-size: 12px;">Default password: password123</small>
            </div>
            <div class="alert alert-info" id="resetFacultyInfo" style="display: none; margin-bottom: 15px;"></div>
            <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                <button type="button" class="btn btn-secondary"
                    onclick="closeModal('facultyPasswordResetModal')">Cancel</button>
                <button type="button" class="btn btn-success" onclick="resetFacultyPassword()">Reset Password</button>
            </div>
        </div>
    </div>
    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    
</body>

</html>
